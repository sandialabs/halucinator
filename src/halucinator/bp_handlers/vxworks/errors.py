# Copyright 2021 National Technology & Engineering Solutions of Sandia, LLC
# (NTESS). Under the terms of Contract DE-NA0003525 with NTESS,
# the U.S. Government retains certain rights in this software.

"""Module for error printing"""
import logging

from halucinator.bp_handlers.bp_handler import BPHandler, bp_handler

log = logging.getLogger(__name__)

errnos = {
    0x36: "ECONNRESET",
    0x160065: "S_semLib_INVALID_STATE",
    0x880208: "S_ftpLib_REMOTE_SERVER_ERROR_520",
    0x4D: "EBADMSG",
    0x380010: "S_dosFsLib_CANT_DEL_ROOT",
    0x35: "ECONNABORTED",
    0x530006: "S_loadLib_UNRECOGNIZED_RELOCENTRY",
    0x8801C2: "S_ftpLib_REMOTE_SERVER_ERROR_450",
    0x140004: "S_rt11FsLib_NO_FREE_FILE_DESCRIPTORS",
    0x760003: "S_distLib_UNREACHABLE",
    0x290010: "S_netDrv_UNIX_FILE_ERROR",
    0x740010: "S_cdromFsLib_SEMTAKE_ERROR",
    0x3D: "ECONNREFUSED",
    0x710002: "S_sntpcLib_INVALID_ADDRESS",
    0x2E: "EPFNOSUPPORT",
    0x540006: "S_vmLib_NO_FREE_REGIONS",
    0x880101: "S_ftpLib_REMOTE_SERVER_STATUS_257",
    0x610018: "S_loadElfLib_UNSUPPORTED",
    0x2F: "EAFNOSUPPORT",
    0x2D0005: "S_nfsDrv_WRITE_ONLY_CANNOT_READ",
    0x610003: "S_loadElfLib_PHDR_MALLOC",
    0x560002: "S_moduleLib_HOOK_NOT_FOUND",
    0x660005: "S_pppHookLib_INVALID_UNIT",
    0x5C0002: "S_aioPxLib_AIO_NOT_DEFINED",
    0x740006: "S_cdromFsLib_UNNOWN_FILE_SYSTEM",
    0x4A0001: "S_icmpLib_TIMEOUT",
    0x4F0012: "S_loadEcoffLib_FILE_ENDIAN_ERROR",
    0x140006: "S_rt11FsLib_FILE_ALREADY_EXISTS",
    0x7E0009: "S_dmsLib_NO_DISCONNECT",
    0x380016: "S_dosFsLib_DELETED",
    0x670003: "S_tapeFsLib_SERVICE_NOT_AVAILABLE",
    0x730009: "S_netBufLib_INVALID_ARGUMENT",
    0x46000C: "S_rawFsLib_32BIT_OVERFLOW",
    0x550001: "S_mmuLib_INVALID_PAGE_SIZE",
    0x290002: "S_netDrv_SEND_ERROR",
    0x140007: "S_rt11FsLib_BEYOND_FILE_LIMIT",
    0x6A0007: "S_dhcpcLib_BAD_OPTION",
    0x390002: "S_selectLib_NO_SELECT_CONTEXT",
    0x60000A: "S_loadSomCoffLib_SPSTRING_ALLOC",
    0x460005: "S_rawFsLib_ILLEGAL_NAME",
    0x810005: "S_devCfgLib_PARAM_NOT_FOUND",
    0x75000E: "S_loadLib_READ_SECTIONS",
    0x380005: "S_dosFsLib_NOT_FILE",
    0x5E0001: "S_mountLib_ILLEGAL_MODE",
    0x7A0002: "S_if_ul_UNIT_UNINITIALIZED",
    0x530011: "S_loadLib_SYMHDR_READ",
    0x5B000E: "S_m2Lib_GEN_ERR",
    0x8801F7: "S_ftpLib_REMOTE_SERVER_ERROR_503",
    0x290007: "S_netDrv_BAD_EOF_POSITION",
    0x600007: "S_loadSomCoffLib_SPHDR_READ",
    0x320001: "S_hostLib_UNKNOWN_HOST",
    0x290001: "S_netDrv_INVALID_NUMBER_OF_BYTES",
    0x680006: "S_snmpdLib_MIB_ADDITION_FAILURE",
    0x87000A: "S_fastPathLib_NOT_INITIALIZED",
    0x4B0006: "S_tftpLib_NOT_CONNECTED",
    0x610004: "S_loadElfLib_PHDR_READ",
    0x370006: "S_scsiLib_BLANK_CHECK",
    0x70001: "S_dsmLib_UNKNOWN_INSTRUCTION",
    0x1C0004: "S_symLib_SYMBOL_STILL_IN_TABLE",
    0x6B0007: "S_resolvLib_INVALID_ADDRESS",
    0x4E0006: "S_smPktLib_PACKET_TOO_BIG",
    0x600008: "S_loadSomCoffLib_SUBSPHDR_ALLOC",
    0x6B0001: "S_resolvLib_NO_RECOVERY",
    0x560001: "S_moduleLib_MODULE_NOT_FOUND",
    0x16: "EINVAL",
    0x6B0004: "S_resolvLib_NO_DATA",
    0x5C0004: "S_aioPxLib_NO_AIO_DEVICE",
    0x760001: "S_distLib_NOT_INITIALIZED",
    0x61000F: "S_loadElfLib_SST_READ",
    0x760002: "S_distLib_NO_OBJECT_DESTROY",
    0x370018: "S_scsiLib_SOFTWARE_ERROR",
    0x630002: "S_pingLib_TIMEOUT",
    0x8800DD: "S_ftpLib_REMOTE_SERVER_STATUS_221",
    0xD0004: "S_iosLib_TOO_MANY_OPEN_FILES",
    0x610007: "S_loadElfLib_READ_SECTIONS",
    0x610016: "S_loadElfLib_UNRECOGNIZED_RELOCENTRY",
    0xC0002: "S_ioLib_UNKNOWN_REQUEST",
    0x1C0002: "S_symLib_NAME_CLASH",
    0x530012: "S_loadLib_EXTSTR_READ",
    0x880229: "S_ftpLib_REMOTE_SERVER_ERROR_553",
    0x490004: "S_bootpLib_PARSE_ERROR",
    0x730008: "S_netBufLib_NETPOOL_INVALID",
    0x290006: "S_netDrv_SEEK_PAST_EOF_ERROR",
    0x650003: "S_pppSecretLib_SECRET_EXISTS",
    0x140009: "S_rt11FsLib_NO_MORE_FILES_ALLOWED_ON_DISK",
    0x21: "EDEADLK",
    0x380015: "S_dosFsLib_FD_OBSOLETE",
    0x4E0002: "S_smPktLib_MEMORY_ERROR",
    0x670001: "S_tapeFsLib_NO_SEQ_DEV",
    0x2B: "EPROTONOSUPPORT",
    0x680005: "S_snmpdLib_VIEW_LOOKUP_FAILURE",
    0x8801F8: "S_ftpLib_REMOTE_SERVER_ERROR_504",
    0x750009: "S_loadLib_UNEXPECTED_SYM_CLASS",
    0x560003: "S_moduleLib_BAD_CHECKSUM",
    0x14: "ENOTDIR",
    0x2C: "ESOCKTNOSUPPORT",
    0x670004: "S_tapeFsLib_INVALID_BLOCK_SIZE",
    0x610001: "S_loadElfLib_HDR_READ",
    0x770004: "S_distNameLib_DATABASE_FULL",
    0x7E000A: "S_dmsLib_OBJ_ID_ERROR",
    0x670008: "S_tapeFsLib_VOLUME_NOT_AVAILABLE",
    0x670006: "S_tapeFsLib_ILLEGAL_FLAGS",
    0x30: "EADDRINUSE",
    0x53000E: "S_loadLib_READ_SECTIONS",
    0x490003: "S_bootpLib_NO_BROADCASTS",
    0x3B: "ETOOMANYREFS",
    0x68000A: "S_snmpdLib_TRAP_BIND_FAILURE",
    0x4F0006: "S_loadEcoffLib_RELOC_READ",
    0x740009: "S_cdromFsLib_MAX_DIR_HIERARCHY_LEVEL_OVERFLOW",
    0x4A0002: "S_icmpLib_NO_BROADCAST",
    0x13: "ENODEV",
    0x61000C: "S_loadElfLib_SCN_READ",
    0x3D0001: "S_objLib_OBJ_ID_ERROR",
    0xC0006: "S_ioLib_DISK_NOT_PRESENT",
    0x6D0008: "S_muxLib_NO_TK_DEVICE",
    0x53000F: "S_loadLib_LOAD_SECTIONS",
    0x6B0003: "S_resolvLib_HOST_NOT_FOUND",
    0xC0001: "S_ioLib_NO_DRIVER",
    0x610015: "S_loadElfLib_GPREL_REFERENCE",
    0x160066: "S_semLib_INVALID_OPTION",
    0x18: "EMFILE",
    0x8801F6: "S_ftpLib_REMOTE_SERVER_ERROR_502",
    0xC000C: "S_ioLib_CANT_OVERWRITE_DIR",
    0x730004: "S_netBufLib_MEM_UNALIGNED",
    0x250002: "S_remLib_RSH_ERROR",
    0x380008: "S_dosFsLib_DIR_NOT_EMPTY",
    0x10: "EBUSY",
    0x5B000D: "S_m2Lib_READ_ONLY",
    0x610002: "S_loadElfLib_HDR_ERROR",
    0x530001: "S_loadLib_FILE_READ_ERROR",
    0x770003: "S_distNameLib_INVALID_WAIT_TYPE",
    0x420001: "S_classLib_CLASS_ID_ERROR",
    0x4F0011: "S_loadEcoffLib_FILE_READ_ERROR",
    0x490002: "S_bootpLib_INVALID_COOKIE",
    0x8801F4: "S_ftpLib_REMOTE_SERVER_ERROR_500",
    0x7E0005: "S_dmsLib_NAME_UNKNOWN",
    0x110001: "S_memLib_NOT_ENOUGH_MEMORY",
    0x690001: "S_pcmciaLib_BATTERY_DEAD",
    0x370002: "S_scsiLib_WRITE_PROTECTED",
    0x750002: "S_loadLib_REALLOC_ERROR",
    0x380002: "S_dosFsLib_DISK_FULL",
    0x1C000C: "S_symLib_INVALID_SYMTAB_ID",
    0x780002: "S_msgQDistGrpLib_INVALID_OPTION",
    0x4B: "ENOSTR",
    0x660003: "S_pppHookLib_HOOK_ADDED",
    0xD0005: "S_iosLib_CONTROLLER_NOT_PRESENT",
    0x14000B: "S_rt11FsLib_NO_BLOCK_DEVICE",
    0x320003: "S_hostLib_INVALID_PARAMETER",
    0x3B0001: "S_qLib_Q_CLASS_ID_ERROR",
    0x490009: "S_bootpLib_BAD_DEVICE",
    0x430001: "S_intLib_NOT_ISR_CALLABLE",
    0x6A0008: "S_dhcpcLib_OPTION_NOT_PRESENT",
    0x3D0004: "S_objLib_OBJ_TIMEOUT",
    0x410001: "S_msgQLib_INVALID_MSG_LENGTH",
    0x37001A: "S_scsiLib_UNKNOWN_SENSE_DATA",
    0x7E0007: "S_dmsLib_BASIS_UNKNOWN",
    0x610017: "S_loadElfLib_RELOC",
    0x350002: "S_if_sl_UNIT_UNINITIALIZED",
    0x790003: "S_msgQDistLib_INVALID_TIMEOUT",
    0x31: "EADDRNOTAVAIL",
    0x370017: "S_scsiLib_INVALID_TAG_TYPE",
    0x6A0009: "S_dhcpcLib_TIMER_ERROR",
    0x61000B: "S_loadElfLib_RELA_SECTION",
    0x880003: "S_ftpLib_FATAL_TRANSIENT_RESPONSE",
    0x550003: "S_mmuLib_INVALID_DESCRIPTOR",
    0x7D0003: "S_setLib_ARG_NOT_VALID",
    0x20: "EPIPE",
    0xC000B: "S_ioLib_UNFORMATED",
    0x460002: "S_rawFsLib_END_OF_DEVICE",
    0x680008: "S_snmpdLib_INVALID_SNMP_VERSION",
    0xC000A: "S_ioLib_NAME_TOO_LONG",
    0x4B0001: "S_tftpLib_INVALID_ARGUMENT",
    0x780004: "S_msgQDistGrpLib_NO_MATCH",
    0x590005: "S_smNameLib_NAME_ALREADY_EXIST",
    0x8801C3: "S_ftpLib_REMOTE_SERVER_ERROR_451",
    0x620001: "S_mbufLib_ID_INVALID",
    0x700001: "S_dhcpsLib_NOT_INITIALIZED",
    0x800004: "S_igmpRouterLib_INVALID_PORT_NUM",
    0x5B0006: "S_m2Lib_CANT_CREATE_IF_SEM",
    0x250004: "S_remLib_RSH_STDERR_SETUP_FAILED",
    0x730001: "S_netBufLib_MEMSIZE_INVALID",
    0x160068: "S_semLib_INVALID_OPERATION",
    0xD: "EACCES",
    0x600006: "S_loadSomCoffLib_SPHDR_ALLOC",
    0x3F0001: "S_qPriBMapLib_NULL_BMAP_LIST",
    0x7B0002: "S_miiLib_PHY_NULL",
    0x880209: "S_ftpLib_REMOTE_SERVER_ERROR_521",
    0x810007: "S_devCfgLib_NO_NVRAM",
    0x39: "ENOTCONN",
    0x540007: "S_vmLib_ADDRS_NOT_EQUAL",
    0x480004: "S_smLib_NO_REGIONS",
    0x33: "ENETUNREACH",
    0x4F0004: "S_loadEcoffLib_READ_SECTIONS",
    0x2D0003: "S_nfsDrv_CREATE_NO_FILE_NAME",
    0x600005: "S_loadSomCoffLib_OBJ_FMT",
    0x580001: "S_smObjLib_NOT_INITIALIZED",
    0x870003: "S_fastPathLib_INTERNAL_ERROR",
    0x420002: "S_classLib_NO_CLASS_DESTROY",
    0x740012: "S_cdromFsLib_VOL_UNMOUNTED",
    0xF: "ENOTEMPTY",
    0x470002: "S_arpLib_INVALID_HOST",
    0x740004: "S_cdromFsLib_SUCH_PATH_TABLE_SIZE_NOT_SUPPORTED",
    0x7C0001: "S_poolLib_ARG_NOT_VALID",
    0x370016: "S_scsiLib_BUS_RESET",
    0xC0008: "S_ioLib_CANCELLED",
    0x7A0004: "S_if_ul_NO_UNIX_DEVICE",
    0x41: "EHOSTUNREACH",
    0x610006: "S_loadElfLib_SHDR_READ",
    0x5: "EIO",
    0x740015: "S_cdromFsLib_INVALID_DIR_REC_STRUCT",
    0x740005: "S_cdromFsLib_ONE_OF_VALUES_NOT_POWER_OF_2",
    0xC0005: "S_ioLib_WRITE_PROTECTED",
    0x370010: "S_scsiLib_ILLEGAL_PARAMETER",
    0x650001: "S_pppSecretLib_NOT_INITIALIZED",
    0xC0003: "S_ioLib_DEVICE_ERROR",
    0x850001: "S_cbioLib_INVALID_CBIO_DEV_ID",
    0x870008: "S_fastPathLib_INVALID_STATE",
    0x380004: "S_dosFsLib_NO_FREE_FILE_DESCRIPTORS",
    0x6A000A: "S_dhcpcLib_OPTION_NOT_STORED",
    0x380007: "S_dosFsLib_NOT_DIRECTORY",
    0x6D0002: "S_muxLib_NO_DEVICE",
    0x2D0007: "S_nfsDrv_NOT_AN_NFS_DEVICE",
    0xD0007: "S_iosLib_INVALID_ETHERNET_ADDRESS",
    0x3E0001: "S_qPriHeapLib_NULL_HEAP_ARRAY",
    0x34: "ENETRESET",
    0xD0001: "S_iosLib_DEVICE_NOT_FOUND",
    0x750007: "S_loadLib_REFHALF_OVFL",
    0x6A0004: "S_dhcpcLib_MEM_ERROR",
    0x540003: "S_vmLib_BAD_MASK_PARAM",
    0xB: "EAGAIN",
    0x770001: "S_distNameLib_NAME_TOO_LONG",
    0x2D0008: "S_nfsDrv_NO_HOST_NAME_SPECIFIED",
    0x370015: "S_scsiLib_DISCONNECTED",
    0x670005: "S_tapeFsLib_ILLEGAL_FILE_SYSTEM_NAME",
    0x4B0007: "S_tftpLib_TIMED_OUT",
    0x5B000C: "S_m2Lib_BAD_VALUE",
    0x3E: "ENETDOWN",
    0x22: "ENOLCK",
    0x480001: "S_smLib_MEMORY_ERROR",
    0xA: "ECHILD",
    0x88022A: "S_ftpLib_REMOTE_SERVER_ERROR_554",
    0x28: "EDESTADDRREQ",
    0x7A0001: "S_if_ul_INVALID_UNIT_NUMBER",
    0x430002: "S_intLib_VEC_TABLE_WP_UNAVAILABLE",
    0x6D0003: "S_muxLib_INVALID_ARGS",
    0x38000F: "S_dosFsLib_ILLEGAL_NAME",
    0x720001: "S_sntpsLib_INVALID_PARAMETER",
    0x75000F: "S_loadLib_LOAD_SECTIONS",
    0x380019: "S_dosFsLib_ILLEGAL_PATH",
    0x4C0002: "S_proxyArpLib_INVALID_INTERFACE",
    0x550002: "S_mmuLib_NO_DESCRIPTOR",
    0x860000: "S_eventLib_NULL_TASKID_AT_INT_LEVEL",
    0x67000A: "S_tapeFsLib_INVALID_NUMBER_OF_BYTES",
    0x4B0008: "S_tftpLib_TFTP_ERROR",
    0x600011: "S_loadSomCoffLib_RELOC_VERSION",
    0x9: "EBADF",
    0x880002: "S_ftpLib_TRANSIENT_RETRY_LIMIT_EXCEEDED",
    0x360002: "S_loginLib_USER_ALREADY_EXISTS",
    0x38001C: "S_dosFsLib_UNKNOWN_VOLUME_FORMAT",
    0x380001: "S_dosFsLib_32BIT_OVERFLOW",
    0x2D0006: "S_nfsDrv_READ_ONLY_CANNOT_WRITE",
    0x750001: "S_loadLib_FILE_READ_ERROR",
    0x370019: "S_scsiLib_NO_MORE_THREADS",
    0x5B000A: "S_m2Lib_IF_CNFG_CHANGED",
    0x550006: "S_mmuLib_VIRT_ADDR_OUT_OF_BOUNDS",
    0x6D0001: "S_muxLib_LOAD_FAILED",
    0x530009: "S_loadLib_UNEXPECTED_SYM_CLASS",
    0x290009: "S_netDrv_WRITE_ONLY_CANNOT_READ",
    0x2D0004: "S_nfsDrv_FATAL_ERR_FLUSH_INVALID_CACHE",
    0x470004: "S_arpLib_INVALID_FLAG",
    0x7E000B: "S_dmsLib_ATTR_NOT_VALID",
    0x5C0001: "S_aioPxLib_DRV_NUM_INVALID",
    0x610005: "S_loadElfLib_SHDR_MALLOC",
    0x750013: "S_loadLib_EXTSYM_READ",
    0x5B0008: "S_m2Lib_ARP_PHYSADDR_NOT_SPECIFIED",
    0xE0001: "S_loadLib_ROUTINE_NOT_INSTALLED",
    0x470001: "S_arpLib_INVALID_ARGUMENT",
    0x4E0005: "S_smPktLib_INVALID_PACKET",
    0x350003: "S_if_sl_UNIT_ALREADY_INITIALIZED",
    0x53000A: "S_loadLib_UNRECOGNIZED_SYM_CLASS",
    0x38000B: "S_dosFsLib_NAME_TOO_LONG",
    0x810006: "S_devCfgLib_NO_NVRAM_SPACE",
    0x7D0004: "S_setLib_OBJ_NOT_IN_SET",
    0x3A: "ESHUTDOWN",
    0x6B0006: "S_resolvLib_INVALID_PARAMETER",
    0x2D0001: "S_nfsDrv_INVALID_NUMBER_OF_BYTES",
    0x810001: "S_devCfgLib_DCFG_INIT",
    0x680009: "S_snmpdLib_TRAP_CREATE_FAILURE",
    0x390001: "S_selectLib_NO_SELECT_SUPPORT_IN_DRIVER",
    0x600004: "S_loadSomCoffLib_SYMSTR_READ",
    0x790002: "S_msgQDistLib_INVALID_MSG_LENGTH",
    0x740003: "S_cdromFsLib_DEVICE_REMOVED",
    0x590006: "S_smNameLib_DATABASE_FULL",
    0x380013: "S_dosFsLib_NO_LABEL",
    0x710003: "S_sntpcLib_TIMEOUT",
    0x110002: "S_memLib_INVALID_NBYTES",
    0x4F000E: "S_loadEcoffLib_REFHALF_OVFL",
    0x4A0003: "S_icmpLib_INVALID_INTERFACE",
    0x75000A: "S_loadLib_UNRECOGNIZED_SYM_CLASS",
    0x600002: "S_loadSomCoffLib_AUXHDR_READ",
    0x580003: "S_smObjLib_NOT_A_LOCAL_ADRS",
    0x37000C: "S_scsiLib_ILLEGAL_BUS_ID",
    0x670009: "S_tapeFsLib_BLOCK_SIZE_MISMATCH",
    0x380009: "S_dosFsLib_FILE_EXISTS",
    0x37000A: "S_scsiLib_SELECT_TIMEOUT",
    0x30066: "S_taskLib_TASK_HOOK_TABLE_FULL",
    0x7C0002: "S_poolLib_INVALID_POOL_ID",
    0x2D0009: "S_nfsDrv_PERMISSION_DENIED",
    0x680003: "S_snmpdLib_VIEW_MASK_FAILURE",
    0x310001: "S_errnoLib_NO_STAT_SYM_TBL",
    0x4F000B: "S_loadEcoffLib_JMPADDR_ERROR",
    0x490007: "S_bootpLib_MEM_ERROR",
    0x600001: "S_loadSomCoffLib_HDR_READ",
    0x75000B: "S_loadLib_HDR_READ",
    0x68000C: "S_snmpdLib_INVALID_OID_SYNTAX",
    0x6A0001: "S_dhcpcLib_NOT_INITIALIZED",
    0x480003: "S_smLib_NOT_ATTACHED",
    0x73000A: "S_netBufLib_NO_POOL_MEMORY",
    0x5B0007: "S_m2Lib_CANT_CREATE_ROUTE_SEM",
    0x600010: "S_loadSomCoffLib_RELOC_NEW",
    0x540005: "S_vmLib_TEXT_PROTECTION_UNAVAILABLE",
    0x7C0005: "S_poolLib_STATIC_POOL_EMPTY",
    0x290011: "S_netDrv_ILLEGAL_VALUE",
    0x4C: "EPROTO",
    0x19: "ENOTTY",
    0x770005: "S_distNameLib_INCORRECT_LENGTH",
    0x7C0003: "S_poolLib_NOT_POOL_ITEM",
    0x74000D: "S_cdromFsLib_READ_ONLY_DEVICE",
    0x680002: "S_snmpdLib_VIEW_INSTALL_FAILURE",
    0x460004: "S_rawFsLib_INVALID_NUMBER_OF_BYTES",
    0x4E000A: "S_smPktLib_LIST_FULL",
    0x37001B: "S_scsiLib_INVALID_BLOCK_SIZE",
    0x1D: "ESPIPE",
    0x530013: "S_loadLib_EXTSYM_READ",
    0x8801F5: "S_ftpLib_REMOTE_SERVER_ERROR_501",
    0x750011: "S_loadLib_SYMHDR_READ",
    0x25: "EDOM",
    0x750004: "S_loadLib_NO_REFLO_PAIR",
    0x74000E: "S_cdromFsLib_END_OF_FILE",
    0x4F000D: "S_loadEcoffLib_UNRECOGNIZED_RELOCENTRY",
    0x4C0006: "S_proxyArpLib_TIMEOUT",
    0x30068: "S_taskLib_TASK_SWAP_HOOK_REFERENCED",
    0x800005: "S_igmpRouterLib_NOT_ALL_IFS_DOWN",
    0x74000C: "S_cdromFsLib_INVALID_FILE_DESCRIPTOR",
    0x870004: "S_fastPathLib_INVALID_ARG",
    0x490006: "S_bootpLib_TIME_OUT",
    0x46000B: "S_rawFsLib_INVALID_PARAMETER",
    0x140003: "S_rt11FsLib_FILE_NOT_FOUND",
    0x140008: "S_rt11FsLib_INVALID_DEVICE_PARAMETERS",
    0x380012: "S_dosFsLib_ROOT_DIR_FULL",
    0x2E0002: "S_nfsLib_NFS_INAPPLICABLE_FILE_TYPE",
    0x29000B: "S_netDrv_READ_ERROR",
    0x4E0001: "S_smPktLib_SHARED_MEM_TOO_SMALL",
    0x580005: "S_smObjLib_TOO_MANY_CPU",
    0x12: "EXDEV",
    0x550005: "S_mmuLib_OUT_OF_PMEGS",
    0x590002: "S_smNameLib_NAME_TOO_LONG",
    0x460003: "S_rawFsLib_NO_FREE_FILE_DESCRIPTORS",
    0x110005: "S_memLib_PAGE_SIZE_UNAVAILABLE",
    0x6A0003: "S_dhcpcLib_MAX_LEASES_REACHED",
    0x6D0007: "S_muxLib_NOT_A_TK_DEVICE",
    0xC: "ENOMEM",
    0x3006C: "S_taskLib_TASK_UNDELAYED",
    0x4C0001: "S_proxyArpLib_INVALID_PARAMETER",
    0x74000A: "S_cdromFsLib_NO_SUCH_FILE_OR_DIRECTORY",
    0x3C: "ETIMEDOUT",
    0x2C0001: "S_routeLib_ILLEGAL_INTERNET_ADDRESS",
    0x30069: "S_taskLib_TASK_SWAP_HOOK_SET",
    0x800001: "S_igmpRouterLib_NOT_INITIALIZED",
    0x53000D: "S_loadLib_SCNHDR_READ",
    0x140002: "S_rt11FsLib_DISK_FULL",
    0xD0003: "S_iosLib_INVALID_FILE_DESCRIPTOR",
    0x780001: "S_msgQDistGrpLib_NAME_TOO_LONG",
    0x370009: "S_scsiLib_UNIT_ATTENTION",
    0x720002: "S_sntpsLib_INVALID_ADDRESS",
    0x7E0008: "S_dmsLib_NO_CONNECT",
    0x6A0006: "S_dhcpcLib_NOT_BOUND",
    0x530005: "S_loadLib_GPREL_REFERENCE",
    0x870007: "S_fastPathLib_INVALID_PROTO",
    0x29: "EPROTOTYPE",
    0x610019: "S_loadElfLib_REL_SECTION",
    0x6A0005: "S_dhcpcLib_BAD_COOKIE",
    0x4E0004: "S_smPktLib_NOT_ATTACHED",
    0x590007: "S_smNameLib_INVALID_WAIT_TYPE",
    0x380003: "S_dosFsLib_FILE_NOT_FOUND",
    0x60000B: "S_loadSomCoffLib_SPSTRING_READ",
    0x2B0001: "S_inetLib_ILLEGAL_INTERNET_ADDRESS",
    0x580007: "S_smObjLib_NO_OBJECT_DESTROY",
    0x3006A: "S_taskLib_TASK_SWAP_HOOK_CLEAR",
    0x7A0003: "S_if_ul_UNIT_ALREADY_INITIALIZED",
    0x870002: "S_fastPathLib_ALREADY_REGISTERED",
    0xE0002: "S_loadLib_TOO_MANY_SYMBOLS",
    0x800003: "S_igmpRouterLib_NO_FREE_VIFS",
    0x1C0003: "S_symLib_TABLE_NOT_EMPTY",
    0x380018: "S_dosFsLib_WRITE_ONLY",
    0x4B0005: "S_tftpLib_UNKNOWN_HOST",
    0x7B0003: "S_miiLib_PHY_NO_ABLE",
    0x370013: "S_scsiLib_ILLEGAL_OPERATION",
    0x460001: "S_rawFsLib_VOLUME_NOT_AVAILABLE",
    0xC0009: "S_ioLib_NO_DEVICE_NAME_IN_PATH",
    0x680007: "S_snmpdLib_NODE_NOT_FOUND",
    0x620002: "S_mbufLib_ID_EMPTY",
    0x380014: "S_dosFsLib_NO_CONTIG_SPACE",
    0x290008: "S_netDrv_SEEK_FATAL_ERROR",
    0x7B0004: "S_miiLib_PHY_AN_FAIL",
    0x8801C4: "S_ftpLib_REMOTE_SERVER_ERROR_452",
    0x74000B: "S_cdromFsLib_INVALID_DIRECTORY_STRUCTURE",
    0x7E000D: "S_dmsLib_DRIVER_INACTIVE",
    0x61000A: "S_loadElfLib_SYMTAB",
    0x540004: "S_vmLib_ADDR_IN_GLOBAL_SPACE",
    0x38000A: "S_dosFsLib_INVALID_PARAMETER",
    0x38000E: "S_dosFsLib_INVALID_NUMBER_OF_BYTES",
    0x60000E: "S_loadSomCoffLib_RELOC_ALLOC",
    0x37000B: "S_scsiLib_LUN_NOT_PRESENT",
    0x590001: "S_smNameLib_NOT_INITIALIZED",
    0x8801A9: "S_ftpLib_REMOTE_SERVER_ERROR_425",
    0x750006: "S_loadLib_UNRECOGNIZED_RELOCENTRY",
    0x4F0002: "S_loadEcoffLib_OPTHDR_READ",
    0x30065: "S_taskLib_NAME_NOT_FOUND",
    0x880212: "S_ftpLib_REMOTE_SERVER_ERROR_530",
    0x160067: "S_semLib_INVALID_QUEUE_TYPE",
    0x4A0004: "S_icmpLib_INVALID_ARGUMENT",
    0x15: "EISDIR",
    0x5B0009: "S_m2Lib_IF_TBL_IS_EMPTY",
    0x29000A: "S_netDrv_READ_ONLY_CANNOT_WRITE",
    0x480002: "S_smLib_INVALID_CPU_NUMBER",
    0x1: "EPERM",
    0x6D0009: "S_muxLib_END_BIND_FAILED",
    0x490001: "S_bootpLib_INVALID_ARGUMENT",
    0x7D0001: "S_setLib_LIB_INIT",
    0x2D000A: "S_nfsDrv_NO_SUCH_FILE_OR_DIR",
    0x8801A6: "S_ftpLib_REMOTE_SERVER_ERROR_422",
    0x470003: "S_arpLib_INVALID_ENET_ADDRESS",
    0x3006B: "S_taskLib_TASK_VAR_NOT_FOUND",
    0x600009: "S_loadSomCoffLib_SUBSPHDR_READ",
    0x5B0005: "S_m2Lib_CANT_CREATE_SYS_SEM",
    0x290005: "S_netDrv_BAD_SEEK",
    0x580002: "S_smObjLib_NOT_A_GLOBAL_ADRS",
    0x390003: "S_selectLib_WIDTH_OUT_OF_RANGE",
    0x250003: "S_remLib_IDENTITY_TOO_BIG",
    0x30067: "S_taskLib_TASK_HOOK_NOT_FOUND",
    0x740011: "S_cdromFsLib_SEMGIVE_ERROR",
    0x630001: "S_pingLib_NOT_INITIALIZED",
    0xC0004: "S_ioLib_DEVICE_TIMEOUT",
    0x1F: "EMLINK",
    0x53000B: "S_loadLib_HDR_READ",
    0x38000D: "S_dosFsLib_VOLUME_NOT_AVAILABLE",
    0xC0007: "S_ioLib_NO_FILENAME",
    0x880001: "S_ftpLib_ILLEGAL_VALUE",
    0x4B0003: "S_tftpLib_INVALID_COMMAND",
    0x800006: "S_igmpRouterLib_THRESHOLD_REQUIRED",
    0x14000A: "S_rt11FsLib_ENTRY_NUMBER_TOO_BIG",
    0x670007: "S_tapeFsLib_FILE_DESCRIPTOR_BUSY",
    0x360003: "S_loginLib_INVALID_PASSWORD",
    0x75000C: "S_loadLib_OPTHDR_READ",
    0x650002: "S_pppSecretLib_SECRET_DOES_NOT_EXIST",
    0x520001: "S_bootLoadLib_ROUTINE_NOT_INSTALLED",
    0x68000B: "S_snmpdLib_TRAP_ENCODE_FAILURE",
    0x870005: "S_fastPathLib_INVALID_OBJ",
    0x4F: "ETIME",
    0x530004: "S_loadLib_NO_REFLO_PAIR",
    0x880226: "S_ftpLib_REMOTE_SERVER_ERROR_550",
    0x370001: "S_scsiLib_DEV_NOT_READY",
    0x8800E2: "S_ftpLib_REMOTE_SERVER_STATUS_226",
    0x6: "ENXIO",
    0x3: "ESRCH",
    0x60000F: "S_loadSomCoffLib_RELOC_READ",
    0x23: "ENOTSUP",
    0x730005: "S_netBufLib_MEMSIZE_UNALIGNED",
    0x490005: "S_bootpLib_INVALID_TAG",
    0x810002: "S_devCfgLib_DCFG_NOT_INIT",
    0x4F0009: "S_loadEcoffLib_EXTSYM_READ",
    0x29000F: "S_netDrv_IS_A_DIRECTORY",
    0x730002: "S_netBufLib_CLSIZE_INVALID",
    0x730007: "S_netBufLib_MBLK_INVALID",
    0x7C0004: "S_poolLib_POOL_IN_USE",
    0x710001: "S_sntpcLib_INVALID_PARAMETER",
    0x4F000A: "S_loadEcoffLib_GPREL_REFERENCE",
    0x370012: "S_scsiLib_ABORTED",
    0x790001: "S_msgQDistLib_INVALID_PRIORITY",
    0x460008: "S_rawFsLib_FD_OBSOLETE",
    0x810004: "S_devCfgLib_DEVICE_NOT_FOUND",
    0x50: "ENOMSG",
    0x600003: "S_loadSomCoffLib_SYM_READ",
    0x370014: "S_scsiLib_DEVICE_EXIST",
    0x750010: "S_loadLib_RELOC_READ",
    0x530008: "S_loadLib_FILE_ENDIAN_ERROR",
    0x320002: "S_hostLib_HOST_ALREADY_ENTERED",
    0x37000E: "S_scsiLib_REQ_SENSE_ERROR",
    0x38001B: "S_dosFsLib_DIR_READ_ONLY",
    0x760004: "S_distLib_UNKNOWN_REQUEST",
    0x4E0007: "S_smPktLib_INVALID_CPU_NUMBER",
    0x37: "ENOBUFS",
    0x48: "ECANCELED",
    0x3006D: "S_taskLib_ILLEGAL_PRIORITY",
    0x4E: "ENODATA",
    0x690002: "S_pcmciaLib_BATTERY_WARNING",
    0x4E0009: "S_smPktLib_INCOMPLETE_BROADCAST",
    0x500001: "S_loadAoutLib_TOO_MANY_SYMBOLS",
    0x660004: "S_pppHookLib_HOOK_UNKNOWN",
    0x870001: "S_fastPathLib_ALREADY_EXISTS",
    0x4E0008: "S_smPktLib_DEST_NOT_ATTACHED",
    0x46: "EWOULDBLOCK",
    0x610008: "S_loadElfLib_LOAD_SECTIONS",
    0x6D0004: "S_muxLib_ALLOC_FAILED",
    0x60000D: "S_loadSomCoffLib_LOAD_SPACE",
    0x580004: "S_smObjLib_SHARED_MEM_TOO_SMALL",
    0x620005: "S_mbufLib_OFFSET_INVALID",
    0x2B0002: "S_inetLib_ILLEGAL_NETWORK_NUMBER",
    0x140001: "S_rt11FsLib_VOLUME_NOT_AVAILABLE",
    0x4C0004: "S_proxyArpLib_INVALID_CLIENT",
    0x530014: "S_loadLib_NO_RELOCATION_ROUTINE",
    0x3D0002: "S_objLib_OBJ_UNAVAILABLE",
    0x4E000B: "S_smPktLib_LOCK_TIMEOUT",
    0x460007: "S_rawFsLib_READ_ONLY",
    0x7E000E: "S_dmsLib_INVALID_CLASS",
    0x2D: "EOPNOTSUPP",
    0x790004: "S_msgQDistLib_NOT_GROUP_CALLABLE",
    0x140005: "S_rt11FsLib_INVALID_NUMBER_OF_BYTES",
    0x490008: "S_bootpLib_NOT_INITIALIZED",
    0x5B0001: "S_m2Lib_INVALID_PARAMETER",
    0x680004: "S_snmpdLib_VIEW_DEINSTALL_FAILURE",
    0x660002: "S_pppHookLib_HOOK_DELETED",
    0x410003: "S_msgQLib_INVALID_QUEUE_TYPE",
    0x5B0004: "S_m2Lib_INVALID_VAR_TO_SET",
    0x370008: "S_scsiLib_VOLUME_OVERFLOW",
    0x3D0005: "S_objLib_OBJ_NO_METHOD",
    0x17: "ENFILE",
    0x670002: "S_tapeFsLib_ILLEGAL_TAPE_CONFIG_PARM",
    0x750012: "S_loadLib_EXTSTR_READ",
    0x11: "EEXIST",
    0x1E: "EROFS",
    0x7E0003: "S_dmsLib_ARG_NOT_VALID",
    0x800002: "S_igmpRouterLib_VIF_OUT_OF_RANGE",
    0x110004: "S_memLib_NO_PARTITION_DESTROY",
    0x1A: "ENAMETOOLONG",
    0x740001: "S_cdromFsLib_ALREADY_INIT",
    0x250001: "S_remLib_ALL_PORTS_IN_USE",
    0x51: "ERRMAX",
    0x61000D: "S_loadElfLib_SDA_MALLOC",
    0x370004: "S_scsiLib_HARDWARE_ERROR",
    0x750003: "S_loadLib_JMPADDR_ERROR",
    0x1C000D: "S_symLib_INVALID_SYM_ID_PTR",
    0x230001: "S_usrLib_NOT_ENOUGH_ARGS",
    0x4: "EINTR",
    0x710004: "S_sntpcLib_VERSION_UNSUPPORTED",
    0x740014: "S_cdromFsLib_READING_FAILURE",
    0x360001: "S_loginLib_UNKNOWN_USER",
    0x4F0005: "S_loadEcoffLib_LOAD_SECTIONS",
    0x1C: "ENOSPC",
    0x6B0002: "S_resolvLib_TRY_AGAIN",
    0x610014: "S_loadElfLib_JMPADDR_ERROR",
    0x110003: "S_memLib_BLOCK_ERROR",
    0x7D0002: "S_setLib_LIB_NOT_INIT",
    0x2D0002: "S_nfsDrv_BAD_FLAG_MODE",
    0x370005: "S_scsiLib_ILLEGAL_REQUEST",
    0x5B000B: "S_m2Lib_TOO_BIG",
    0x7E0004: "S_dmsLib_NAME_NOT_UNIQUE",
    0x74000F: "S_cdromFsLib_INV_ARG_VALUE",
    0x770002: "S_distNameLib_ILLEGAL_LENGTH",
    0x32: "ENOTSOCK",
    0x4F000C: "S_loadEcoffLib_NO_REFLO_PAIR",
    0x43: "EHOSTDOWN",
    0x7B0001: "S_miiLib_PHY_LINK_DOWN",
    0x750005: "S_loadLib_GPREL_REFERENCE",
    0x2C0002: "S_routeLib_ILLEGAL_NETWORK_NUMBER",
    0x75000D: "S_loadLib_SCNHDR_READ",
    0x38000C: "S_dosFsLib_UNSUPPORTED",
    0x410002: "S_msgQLib_NON_ZERO_TIMEOUT_AT_INT_LEVEL",
    0x1B: "EFBIG",
    0x6B0005: "S_resolvLib_BUFFER_2_SMALL",
    0x740008: "S_cdromFsLib_INVALID_PATH_STRING",
    0x46000A: "S_rawFsLib_BAD_SEEK",
    0x870009: "S_fastPathLib_NOT_FOUND",
    0x380017: "S_dosFsLib_INTERNAL_ERROR",
    0x7E000C: "S_dmsLib_NOT_SUPPORTED",
    0x3D0003: "S_objLib_OBJ_DELETED",
    0x6D0006: "S_muxLib_UNLOAD_FAILED",
    0x730003: "S_netBufLib_NO_SYSTEM_MEMORY",
    0x2E0001: "S_nfsLib_NFS_AUTH_UNIX_FAILED",
    0x880228: "S_ftpLib_REMOTE_SERVER_ERROR_552",
    0x44: "EINPROGRESS",
    0x3F: "ETXTBSY",
    0x47: "ENOSYS",
    0x6D0005: "S_muxLib_ALREADY_BOUND",
    0x530007: "S_loadLib_REFHALF_OVFL",
    0x2: "ENOENT",
    0x620003: "S_mbufLib_SEGMENT_NOT_FOUND",
    0x53000C: "S_loadLib_OPTHDR_READ",
    0x7E0006: "S_dmsLib_DRIVER_UNKNOWN",
    0x370003: "S_scsiLib_MEDIUM_ERROR",
    0x620004: "S_mbufLib_LENGTH_INVALID",
    0x40: "ELOOP",
    0x4F0001: "S_loadEcoffLib_HDR_READ",
    0x540001: "S_vmLib_NOT_PAGE_ALIGNED",
    0x350001: "S_if_sl_INVALID_UNIT_NUMBER",
    0x24: "EMSGSIZE",
    0x7E0002: "S_dmsLib_DMS_NOT_INIT",
    0x460009: "S_rawFsLib_NO_BLOCK_DEVICE",
    0x740013: "S_cdromFsLib_INVAL_DIR_OPER",
    0x370011: "S_scsiLib_INVALID_PHASE",
    0x370007: "S_scsiLib_ABORTED_COMMAND",
    0x740007: "S_cdromFsLib_INVAL_VOL_DESCR",
    0x750008: "S_loadLib_FILE_ENDIAN_ERROR",
    0x4B0004: "S_tftpLib_INVALID_MODE",
    0x730006: "S_netBufLib_MEMAREA_INVALID",
    0x7: "E2BIG",
    0x45: "EALREADY",
    0x37000D: "S_scsiLib_NO_CONTROLLER",
    0x290004: "S_netDrv_UNKNOWN_REQUEST",
    0xE: "EFAULT",
    0x450001: "S_cacheLib_INVALID_CACHE",
    0x6A0002: "S_dhcpcLib_BAD_DEVICE",
    0x29000C: "S_netDrv_WRITE_ERROR",
    0x790005: "S_msgQDistLib_RMT_MEMORY_SHORTAGE",
    0x4F0003: "S_loadEcoffLib_SCNHDR_READ",
    0x38001A: "S_dosFsLib_ACCESS_BEYOND_EOF",
    0x6E0001: "S_m2RipLib_IFACE_NOT_FOUND",
    0x660001: "S_pppHookLib_NOT_INITIALIZED",
    0x4F000F: "S_loadEcoffLib_UNEXPECTED_SYM_CLASS",
    0x760005: "S_distLib_OBJ_ID_ERROR",
    0x530003: "S_loadLib_JMPADDR_ERROR",
    0x2D000B: "S_nfsDrv_IS_A_DIRECTORY",
    0xD0002: "S_iosLib_DRIVER_GLUT",
    0x8: "ENOEXEC",
    0x29000E: "S_netDrv_PERMISSION_DENIED",
    0x2A: "ENOPROTOOPT",
    0x3A0001: "S_hashLib_KEY_CLASH",
    0x1C0001: "S_symLib_SYMBOL_NOT_FOUND",
    0x4F0007: "S_loadEcoffLib_SYMHDR_READ",
    0x530002: "S_loadLib_REALLOC_ERROR",
    0x570002: "S_unldLib_TEXT_IN_USE",
    0x590003: "S_smNameLib_NAME_NOT_FOUND",
    0x880227: "S_ftpLib_REMOTE_SERVER_ERROR_551",
    0x460006: "S_rawFsLib_NOT_FILE",
    0xD0006: "S_iosLib_DUPLICATE_DEVICE_NAME",
    0x4C0005: "S_proxyArpLib_INVALID_ADDRESS",
    0x540002: "S_vmLib_BAD_STATE_PARAM",
    0x5B0003: "S_m2Lib_TCPCONN_FD_NOT_FOUND",
    0x810003: "S_devCfgLib_PARAM_VAL_NOT_VALID",
    0x38: "EISCONN",
    0x380011: "S_dosFsLib_READ_ONLY",
    0x37000F: "S_scsiLib_DEV_UNSUPPORTED",
    0x680001: "S_snmpdLib_VIEW_CREATE_FAILURE",
    0x5B0002: "S_m2Lib_ENTRY_NOT_FOUND",
    0x380006: "S_dosFsLib_NOT_SAME_VOLUME",
    0x4E0003: "S_smPktLib_DOWN",
    0x7E0001: "S_dmsLib_DMS_INIT",
    0x4A: "ENOSR",
    0x29000D: "S_netDrv_NO_SUCH_FILE_OR_DIR",
    0x610009: "S_loadElfLib_LOAD_PROG",
    0x5C0003: "S_aioPxLib_IOS_NOT_INITIALIZED",
    0x4F0010: "S_loadEcoffLib_UNRECOGNIZED_SYM_CLASS",
    0x4F0008: "S_loadEcoffLib_EXTSTR_READ",
    0x60000C: "S_loadSomCoffLib_INFO_ALLOC",
    0x710005: "S_sntpcLib_SERVER_UNSYNC",
    0x290003: "S_netDrv_RECV_ERROR",
    0x4B0002: "S_tftpLib_INVALID_DESCRIPTOR",
    0x580006: "S_smObjLib_LOCK_TIMEOUT",
    0x590004: "S_smNameLib_VALUE_NOT_FOUND",
    0x570001: "S_unldLib_MODULE_NOT_FOUND",
    0x560004: "S_moduleLib_MAX_MODULES_LOADED",
    0x870006: "S_fastPathLib_INVALID_PARAMS",
    0x780003: "S_msgQDistGrpLib_DATABASE_FULL",
    0x26: "ERANGE",
    0x38001D: "S_dosFsLib_ILLEGAL_CLUSTER_NUMBER",
    0x42: "ENOTBLK",
    0x4C0003: "S_proxyArpLib_INVALID_PROXY_NET",
    0x530010: "S_loadLib_RELOC_READ",
    0x790006: "S_msgQDistLib_OVERALL_TIMEOUT",
}


def get_error_type(errno):
    """
    Look up the error to print
    """
    if errno in errnos.keys():
        return errnos[errno]
    return "ERROR_TYPE_UNDEFINED_%s" % (hex(errno))


class BColors:
    """
    pretty coloring for the error to stick out
    """

    OKBLUE = "\033[94m"
    OKGREEN = "\033[92m"
    WARNING = "\033[93m"
    FAIL = "\033[91m"
    ENDC = "\033[0m"
    BOLD = "\033[1m"


class ERROR(BPHandler):
    """bp_handler for errors"""

    def __init__(self):
        self.last_error = None

    @bp_handler(["errnoSet"])
    def errno_set(self, qemu, bp_handler):
        if qemu.regs.r0 != 0:
            error_type = get_error_type(qemu.regs.r0)
            lr = qemu.regs.lr
            sym = qemu.get_symbol_name(lr)
            sym = "%s (%s)" % (hex(lr), sym) if sym is not None else hex(lr)
            error = "Errno Set :%s from %s" % (error_type, sym)
            if self.last_error != error:
                self.last_error = error
                log.info(BColors.WARNING + error + BColors.ENDC)
        return False, None

    @bp_handler(["__errno"])
    def __errno(self, qemu, bp_handler):
        log.debug(hex(qemu.regs.r0))
        errno = qemu.read_memory(qemu.regs.r0, 4)
        if errno != 0:
            error_type = get_error_type(errno)
            log.info("Errno: %s from %s" % (error_type, hex(qemu.regs.lr)))
            log.debug(
                BColors.WARNING + "Errno: %s from %s",
                (error_type, hex(qemu.regs.lr)) + BColors.ENDC,
            )
        return False, None
